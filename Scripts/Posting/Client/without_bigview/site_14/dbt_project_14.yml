# Name your project! Project names should contain only lowercase characters
# and underscores. A good package name should reflect your organization's
# name or the intended use of these models
name: "dbt_project"
version: "1.0.0"

# This setting configures which "profile" dbt uses for this project.
profile: "dbt_project"

# These configurations specify where dbt should look for different types of files.
# The `model-paths` config, for example, states that models in this project can be
# found in the "models/" directory. You probably won't need to change these!
model-paths: ["models"]
analysis-paths: ["analyses"]
test-paths: ["tests"]
seed-paths: ["seeds"]
macro-paths: ["macros"]
snapshot-paths: ["snapshots"]

clean-targets: # directories to be removed by `dbt clean`
  - "target"
  - "dbt_packages"

# Configuring models
# Full documentation: https://docs.getdbt.com/docs/configuring-models

# In this example config, we tell dbt to build all models in the example/
# directory as views. These settings can be overridden in the individual model
# files using the `{{ config(...) }}` macro.
models:
  dbt_project:
    # Config indicated by + and applies to all files under models/example/
    example:
      +materialized: view
    static:
      +materialized: view
    dynamic:
      +materialized: view

vars:
  site: 14
  event_action: "Next Click"

  click_val: '[
  {"field": "id", "label": "ID"}, 
  {"field": "article", "label": "ARTIKEL"}, 
  {"field": "category", "label": "BRUGERBEHOV"}, 
  {"field": "sektion", "label": "ARTIKELTYPE", "hidden": true}, 
  {"field": "tags", "label": "EMNER", "hidden": true}, 
  {"field": "date", "label": "DATO"}, 
  {"field": "brugerbehov", "label": "SIDEVISNINGER"}, 
  {"field": "clicks", "label": "NEXT CLICK (%)"}
  ]'

  condition:
    status: true
    query: "AND categories <> 'Nyhedsoverblik'"

  columns_to_add:
    status: false
    columns_name: NONE
    condition: ""

  # tag_filters_exclude:
  #   status: 'Yes'
  #   statement: ' AND Categories <> "Nyhedsoverblik"'

  Tendency:
    dropdown_cte_naming: ["", "_second", "_third"]

    dropdown_titles: ["Brugerbehov", "Artikeltype", "Emner"]

    dropdown_mapping:
      Brugerbehov: "userneeds"
      Artikeltype: "Categories"
      Emner: "Tags"

    dropdown_values:
      userneeds:
        [
          "Opdater mig",
          "Forbind mig",
          "Hjælp mig med at forstå",
          "Giv mig en fordel",
          "Underhold mig",
          "Inspirer mig",
        ]
      Categories:
        [
          "Nyhedsoverblik",
          "Debat",
          "Guide",
          "Artikel",
          "Digidoc",
          "post",
          "news_overview",
        ]
      Tags:
        [
          "Arbejdsmiljø",
          "Social dumping",
          "Ulighed",
          "Privatøkonomi",
          "Fagligt",
          "Uddannelse",
        ]

    dropdown_values_grouping:
      userneeds:
        [
          "Opdater mig",
          "Forbind mig",
          "Hjælp mig med at forstå",
          "Giv mig en fordel",
          "Underhold mig",
          "Inspirer mig",
        ]
      Categories:
        [
          "Nyhedsoverblik",
          "Debat",
          "Guide",
          "Artikel",
          "Digidoc",
          "post",
          "news_overview",
        ]
      Tags:
        [
          "Arbejdsmiljø",
          "Social dumping",
          "Ulighed",
          "Privatøkonomi",
          "Fagligt",
          "Uddannelse",
        ]

    order_statements:
      userneeds: "'Opdater mig','Forbind mig','Hjælp mig med at forstå','Giv mig en fordel', 'Underhold mig', 'Inspirer mig'"
      Categories: "'Nyhedsoverblik', 'Debat', 'Guide','Artikel','Digidoc','post','news_overview'"
      Tags: "'Fagligt', 'Arbejdsmiljø', 'Social dumping', 'Uddannelse', 'Ulighed', 'Privatøkonomi'"

  Traffic:
    input_referrers_linechart: "''Direct'',''Search'',''Newsletter'',''NL <47'', ''NL 48-60'',''NL >60'', ''Facebook''"
    output_referrers_linechart: "''Direct'',''Search'',''Facebook'',''Newsletter''"

    # For pageviews_weeks/month/year_dummy_2_3_updated
    domain: "''https://fagbladet3f.dk/''"

    dropdown_cte_naming: ["_first", "_second", "_third"]

    output_referrers_pageviews_channel: "''Forside'', ''Search'', ''Facebook'', ''NL <47'', ''NL 48-60'', ''NL >60''"
    output_referrers_pageviews_channel_traffic: "''Forside'', ''Search'', ''Facebook''"
    output_referrers_pageviews_channel_newsletter: "''NL <47'', ''NL 48-60'', ''NL >60''"

    input_tags_pageviews_channel:
      Brugerbehov: "''Opdater mig'',''Forbind mig'',''Hjælp mig med at forstå'',''Giv mig en fordel'',''Underhold mig'',''Inspirer mig''"
      Artikeltype: "''Debat'',''Artikel'',''Nyhedsoverblik'',''Guide'',''Digidoc''"
      Emner: "''Arbejdsmiljø'', ''Social dumping'',''Ulighed'',''Privatøkonomi'',''Fagligt'',''Uddannelse''"

    # This is used in the table of traffic_channels
    table_grouping:
      # the default columns require no sort of grouping and will be writting as they are in prod.site_archive_post
      default_columns: ["tags", "userneeds", "Categories"]
      # the following will be set to true if we are to create any new column in the table
      grouping_status: false
      # we will define the name of the new column, values will be taken from above
      grouping_columns: ["Emner"]
      # we will also define the JSON for the table output according to the defined column mappings
      table_json: |
        ''category'', coalesce(userneeds, " "),
        ''tags'', coalesce(Tags," "),
        ''sektion'', coalesce(Categories, " "),
      total_columns: 3

    entry_pages_json: |
      [{"field": "id","label": "ID"},{"field": "article","label": "ARTIKEL"},{"field": "category","label": "BRUGERBEHOV"},{"field": "sektion","label": "ARTIKELTYPE", "hidden" : true},{"field": "tags","label": "EMNER", "hidden" : true},{"field": "date","label": "DATO"},{"field": "brugerbehov","label": "Besøg"}]

  # used to modify how the tags/userneeds/sektion values in the table shall be represented (ADD AS STATEMENTS AT THE END)
  table_modification:
    table_modification_tendency:
      userneeds: |
        userneeds
      tags: |
        tags
      Categories: |
        Categories

    table_modification_traffic:
      userneeds: |
        userneeds
      tags: |
        tags
      Categories: |
        Categories

  exploration:
    historic_data: true
    columns: |
      'category', COALESCE(userneeds, ''), 'sektion', COALESCE(tags,''),